<?xml version="1.0" encoding="UTF-8"?>
<openerp>
	<data>
		<record id="sale_view_inherit3" model="ir.ui.view">
			<field name="name">sale.view.inherit3</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="price_methodology.sale_view_inherit"/>
			<field name="arch" type="xml">
				<xpath expr="/form/notebook/page[@string='Other Information']/separator[@string='Notes']" position="replace"/>
				<xpath expr="/form/notebook/page[@string='Other Information']/field[@name='note']" position="replace"/>
				<xpath expr="/form/notebook/page[@string='Other Information']" position="after">
					<page string="SPQ Approve">
						<separator colspan="4" string="SPQ Approve"/>
						<group col="8" colspan="4">
							<field name="spq_approve"/>
							<field name="spq_approve_user" readonly="1" colspan="3"/>
							<field name="spq_date" readonly="1" colspan="3"/>
							<button name="act_approve_spq" attrs="{'invisible': [('spq_approve', '=', True)]}" string="Approved SPQ" type="object" icon="gtk-go-forward" colspan="1"/>
							<button name="act_undo_approve_spq" attrs="{'invisible': [('spq_approve', '!=', True)]}" string="Un-Approved SPQ" type="object" icon="gtk-go-back" colspan="1"/>
						</group>
					</page>
					<page string="Notes">
						<separator colspan="4" string="Header"/>
						<field colspan="4" name="header_so" nolabel="1"/>
						<separator colspan="4" string="Footer"/>
						<field colspan="4" name="footer_so" nolabel="1"/>
						<separator colspan="4" string="Notes"/>
						<field colspan="4" name="note" nolabel="1"/>
					</page>
				</xpath>
				<field name="client_order_ref" position="after">
					<button name="%(act_adding_lines_so)d" string="Add Lines" type="action" icon="gtk-go-forward" states="progress"/>
				</field>
				<field name="pricelist_id" position="replace">
					<field domain="[('type','=','sale')]" name="pricelist_id" groups="base.group_extended" on_change="onchange_pricelist_id2(partner_id)"/>
				</field>
				<field name="incoterm" position="replace">
					<field name="incoterm" widget="selection" groups="so_workflowchange.group_non_user"/>
					<field name="fob_id" widget="selection"/>
					<field name="ship_method_id" widget="selection"/>
					<field name="sales_zone_id" widget="selection"/>
				</field>
				<field name="user_id" position="after">
					<field name="sale_term_id" widget="selection"/>
				</field>
				<button name="order_confirm" position="replace">
					<button name="action_approval" type="object" states="draft" string="Confirm Order" icon="gtk-apply"/>
				</button>
				<button name="action_cancel" position="replace"/>
				<button name="ship_cancel" position="replace"/>
				<button name="cancel" position="replace"/>
				<button name="invoice_cancel" position="replace">
					<button name="button_dummy2" string="Refresh" type="object" icon="gtk-execute"/>
					<button name="wkf_action_cancel" states="manual,progress,shipping_except,invoice_except,draft" string="Cancel Order" type="object" icon="gtk-cancel"/>
					<button name="%(action_sale_order_make_delivery)d" string="Make deliveries"  states="progress"  type="action" icon="terp-gtk-go-back-rtl" />
					<button name="button_check_done" string="Check Done" type="object" icon="gtk-execute"/>
				</button>
				<xpath expr="/form/notebook/page/field[@name='order_line']/form/notebook/page[@string='History']" position="before">
					<page string="Allocated" groups="base.group_extended">
						<field name="qty_onhand_allocated"/>
						<newline/>
						<field name="qty_received_onorder"/>
						<newline/>
						<field name="qty_onhand_count"/>
						<button name="onhand_reallocated" type="object" states="confirmed" string="On Hand Re-Allocated" icon="gtk-execute"/>
						<separator string="GRN Allocated Lines" colspan="4"/>
						<field colspan="4" name="move_allocated_control_ids" nolabel="1" widget="many2many">
						<tree string="GRN Allocated Lines">
							<field name="picking_id"/>
							<field name="product_id"/>
							<field name="quantity"/>
							<field name="rec_quantity"/>
						</tree>
						<form string="GRN Allocated Lines">
							<field name="picking_id"/>
							<field name="product_id"/>
							<field name="quantity"/>
							<field name="rec_quantity"/>
						</form>
						</field>
						<separator string="Purchase Order Allocated Lines" colspan="4"/>
						<field colspan="4" name="allocated_ids" nolabel="1" widget="many2many"/>
						<label string="" colspan="2"/>
						<group col="4" colspan="2">
							<button name="do_refresh" states="confirmed" string="Refresh" type="object" icon="gtk-execute"/>
							<button name="%(act_allocated_po)d" string="Allocated Purchase Order"  states="confirmed"  type="action" icon="gtk-go-forward"/>
						</group>
					</page>
				</xpath>
				<xpath expr="/form/notebook/page/field[@name='order_line']/form/notebook/page/group/group/field[@name='discount']" position="after">
					<field name="location_id" domain="[('usage','=','internal')]"
						on_change="location_onchange(product_id,location_id)"
						colspan="10"/>
					<button name="%(act_change_price)d" string="Change Price Unit" type="action" icon="gtk-go-forward" states="draft,confirmed" invisible="1"/>
					<button name="%(act_change_qty)d" string="Change Qty" type="action" icon="gtk-go-forward" states="confirmed"/>
				</xpath>
				<xpath expr="/form/notebook/page/field[@name='order_line']/form/notebook/page/group/group/field[@name='product_id']" position="replace">
					<field colspan="3"
						context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}"
						name="product_id"
						on_change="product_id_change3(location_id,parent.shop_id.company_id,product_customer_id,effective_date,parent.pricelist_id,product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name,parent.partner_id,False,True,parent.date_order,product_packaging,parent.fiscal_position,False,context)"
						string="Supplier Part No" invisible="1"/>
				</xpath>
				<xpath expr="/form/notebook/page/field[@name='order_line']/form/notebook/page/group/group/field[@name='product_uom_qty']" position="replace">
					<field
						context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'shop':parent.shop_id, 'uom':product_uom}"
						on_change="product_id_change3(location_id,parent.shop_id.company_id,product_customer_id,effective_date,parent.pricelist_id,product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name,parent.partner_id,False,True,parent.date_order,product_packaging,parent.fiscal_position,False,context)"
						name="product_uom_qty"/>
				</xpath>
				<xpath expr="/form/notebook/page/field[@name='order_line']/form/notebook/page/group/group/field[@name='product_uom']" position="replace">
					<field name="product_uom" colspan="2"
						on_change="product_uom_change3(location_id,parent.shop_id.company_id,product_customer_id,effective_date,parent.pricelist_id,product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name,parent.partner_id,False,True,parent.date_order,context)"
						string = "(*)"/>
				</xpath>
				<xpath expr="/form/notebook/page/field[@name='order_line']/form/notebook/page/group/group/field[@name='effective_date']" position="replace">
					<field name="effective_date" string="Sale Price Effective Date"
						on_change="product_id_change3(location_id,parent.shop_id.company_id,product_customer_id,effective_date,parent.pricelist_id,product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name,parent.partner_id,False,True,parent.date_order,product_packaging,parent.fiscal_position,False,context)"
						/>
					<button name="%(act_change_effective)d" string="Change Effective Date" type="action" icon="gtk-go-forward" states="confirmed"/>
				</xpath>
				<xpath expr="/form/notebook/page/field[@name='order_line']/form/notebook/page/group/group/field[@name='price_unit']" position="replace">
					<field name="price_unit"
						on_change="product_id_change3(location_id,parent.shop_id.company_id,product_customer_id,effective_date,parent.pricelist_id,product_id,product_uom_qty,product_uom,product_uos_qty,product_uos,name,parent.partner_id,False,True,parent.date_order,product_packaging,parent.fiscal_position,False,context)"
						string="Unit Price (*)"/>
				</xpath>
				<xpath expr="/form/notebook/page/field[@name='order_line']/form/notebook/page/field[@name='reschedule_ids']" position="after">
					<separator colspan="4" string="Change Effective History"/>
					<field colspan="4" name="effective_ids" nolabel="1">
						<tree string="Change Effective History">
							<field name="change_date" string="Effective Date"/>
							<field name="create_uid"/>
							<field name="create_date"/>
							<field name="reason" colspan="4"/>
						</tree>
						<form string="Change Effective History">
							<field name="change_date"/>
							<field name="create_uid"/>
							<field name="create_date"/>
							<field name="reason" colspan="4"/>
						</form>
					</field>
				</xpath>

				<xpath expr="/form/notebook/page/field[@name='order_line']/tree/field[@name='product_uom_qty']" position="before">
					<field name="location_id"/>
				</xpath>
				<xpath expr="/form/notebook/page/field[@name='order_line']/tree/field[@name='price_subtotal']" position="after">
					<button name="%(act_delete_so_line_wizard)d" string="Delete Line" type="action" icon="gtk-cancel"/>
				</xpath>
				
			</field>
		</record>
	</data>
</openerp>